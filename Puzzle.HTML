<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Puzzle 1.00</title>
  <style>
    .Button {
      width: 100px;
      height: 100px;
      font-size: 3em;
    }
    .grid-container {
      display: grid;
      grid-template-columns: repeat(4, 100px);
      grid-gap: 10px;
      justify-content: center;
      align-items: center;
      margin-top: 20px;
    }
  </style>
</head>
<body>
	<h2>https://github.com/Tanutdech</h2>
  <div class="grid-container">
    <input type="button" id="Button1" class="Button" onclick="IsCheck(0)">
    <input type="button" id="Button2" class="Button" onclick="IsCheck(1)">
    <input type="button" id="Button3" class="Button" onclick="IsCheck(2)">
    <input type="button" id="Button4" class="Button" onclick="IsCheck(3)">
    <input type="button" id="Button5" class="Button" onclick="IsCheck(4)">
    <input type="button" id="Button6" class="Button" onclick="IsCheck(5)">
    <input type="button" id="Button7" class="Button" onclick="IsCheck(6)">
    <input type="button" id="Button8" class="Button" onclick="IsCheck(7)">
    <input type="button" id="Button9" class="Button" onclick="IsCheck(8)">
    <input type="button" id="Button10" class="Button" onclick="IsCheck(9)">
    <input type="button" id="Button11" class="Button" onclick="IsCheck(10)">
    <input type="button" id="Button12" class="Button" onclick="IsCheck(11)">
    <input type="button" id="Button13" class="Button" onclick="IsCheck(12)">
    <input type="button" id="Button14" class="Button" onclick="IsCheck(13)">
    <input type="button" id="Button15" class="Button" onclick="IsCheck(14)">
    <input type="button" id="Button16" class="Button" onclick="IsCheck(15)">
  </div>

  <script>
    let H = 15;
    let IsR = Array(16).fill(0);

    window.onload = function () {
      IsRandom();
      ShowButton();
    };

    function ShowButton() {
      for (let i = 0; i < 16; i++) {
        const btn = document.getElementById(`Button${i + 1}`);
        btn.value = IsR[i] === 0 ? '' : IsR[i];
      }
    }

    function IsCheck(index) {
      if (IsR[index] !== 0) {
        if (Math.floor(index / 4) === Math.floor(H / 4)) {
          // อยู่ในแถวเดียวกัน
          if (index + 3 === H) {
            IsR[H] = IsR[index + 2];
            IsR[index + 2] = IsR[index + 1];
            IsR[index + 1] = IsR[index];
          } else if (index - 3 === H) {
            IsR[H] = IsR[index - 2];
            IsR[index - 2] = IsR[index - 1];
            IsR[index - 1] = IsR[index];
          } else if (index + 2 === H) {
            IsR[H] = IsR[index + 1];
            IsR[index + 1] = IsR[index];
          } else if (index - 2 === H) {
            IsR[H] = IsR[index - 1];
            IsR[index - 1] = IsR[index];
          } else if (index + 1 === H || index - 1 === H) {
            IsR[H] = IsR[index];
          } else {
            return;
          }
          IsR[index] = 0;
          H = index;
        } else if (index % 4 === H % 4) {
          // อยู่ในคอลัมน์เดียวกัน
          if (index + 12 === H) {
            IsR[H] = IsR[index + 8];
            IsR[index + 8] = IsR[index + 4];
            IsR[index + 4] = IsR[index];
          } else if (index - 12 === H) {
            IsR[H] = IsR[index - 8];
            IsR[index - 8] = IsR[index - 4];
            IsR[index - 4] = IsR[index];
          } else if (index + 8 === H) {
            IsR[H] = IsR[index + 4];
            IsR[index + 4] = IsR[index];
          } else if (index - 8 === H) {
            IsR[H] = IsR[index - 4];
            IsR[index - 4] = IsR[index];
          } else if (index + 4 === H || index - 4 === H) {
            IsR[H] = IsR[index];
          } else {
            return;
          }
          IsR[index] = 0;
          H = index;
        }
      }

      ShowButton();

      if (IsFinish()) {
        alert("Finish...!");
        window.close();
      }
    }

    function IsFinish() {
      for (let i = 0; i < 15; i++) {
        if (IsR[i] !== i + 1) return false;
      }
      return IsR[15] === 0;
    }

    function IsRandom() {
      IsR = Array(16).fill(0);
      let used = new Set();
      for (let i = 0; i < 15; i++) {
        let r;
        do {
          r = Math.floor(Math.random() * 15);
        } while (used.has(r));
        used.add(r);
        IsR[r] = i + 1;
      }
      IsR[15] = 0;
      H = 15;
    }
  </script>
</body>
</html>

